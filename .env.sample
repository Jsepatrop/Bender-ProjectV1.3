# Configuration exemple - Assistant Vocal Bender v1.2
# Copier vers .env.local et remplir les valeurs réelles
# Voir docs/PREREQUIS.md pour les détails

# === ACCÈS MACHINES ===

# Dell T630 (Windows Server 2022)
T630_HOST=192.168.1.xxx
T630_USER=your_admin_user
T630_PASS=your_secure_password
T630_PORT_WINRM=5985
T630_PORT_SSH=22

# Raspberry Pi 5
PI5_HOST=192.168.1.xxx
PI5_USER=bender
PI5_PASS=your_secure_password
PI5_PORT_SSH=22
PI5_KEY_PATH=~/.ssh/id_ed25519

# ESP32
ESP32_MODEL=ESP32_model
ESP32_PORT=COMx_or_/dev/ttyUSBx

# === HOME ASSISTANT & MQTT ===

# Home Assistant
HA_URL=https://your-ha-instance:8123
HA_TOKEN=your_long_lived_access_token
HA_VERSION=2025.x.x

# MQTT Broker (Home Assistant)
MQTT_HOST=192.168.1.xxx
MQTT_PORT=1883
MQTT_TLS_PORT=8883
MQTT_USER=your_mqtt_user
MQTT_PASS=your_mqtt_password

# Utilisateurs MQTT
MQTT_USER_PI=bender-pi
MQTT_PASS_PI=auto_generated_password
MQTT_USER_ESP32=bender-esp32
MQTT_PASS_ESP32=auto_generated_password
MQTT_USER_T630=bender-t630
MQTT_PASS_T630=auto_generated_password

# === MATÉRIEL ===

# GPU T630
T630_GPU_MODEL=your_gpu_model
T630_RAM_GB=xxx
T630_DISK_FREE_GB=xxx

# Réseau
NETWORK_SUBNET=192.168.x.0/24

# TTS Voice
PIPER_VOICE_DEFAULT=fr_FR-siwis-medium
PIPER_VOICE_ACCEPTED=true

# === SÉCURITÉ ===

# Certificats TLS
TLS_CA_PATH=/path/to/ssl
TLS_CERT_PATH=/path/to/ssl
TLS_AUTO_GENERATE=false

# === DÉVELOPPEMENT ===

# Accès Internet
INTERNET_ACCESS=true
PROXY_URL=
BLOCKED_DOMAINS=

# Outils
GIT_INSTALLED=
DOCKER_INSTALLED=
NODEJS_VERSION=
PYTHON_VERSION=
PLATFORMIO_INSTALLED=
# ATTENTION : .env.local ne doit JAMAIS être versionné

# =============================================================================
# ACCÈS MACHINES
# =============================================================================

# Dell T630 (Windows Server 2022 + Docker/WSL2)
T630_HOST=192.168.1.100
T630_USER=Administrator
T630_PASS=VotreMotDePasseSecurise
T630_WINRM_PORT=5985
T630_SSH_PORT=22

# Raspberry Pi 5
PI5_HOST=192.168.1.101
PI5_USER=pi
PI5_SSH_KEY_PATH=/path/to/your/ssh/key
PI5_SSH_PORT=22

# ESP32 (développement)
ESP32_SERIAL_PORT=/dev/ttyUSB0
# Windows: COM3, Linux: /dev/ttyUSB0, macOS: /dev/cu.usbserial-*

# =============================================================================
# HOME ASSISTANT
# =============================================================================

HA_URL=http://192.168.1.50:8123
HA_TOKEN=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
HA_WEBHOOK_ID=bender_webhook_id

# =============================================================================
# MQTT BROKER
# =============================================================================

MQTT_HOST=192.168.1.50
MQTT_PORT=8883
MQTT_TLS_ENABLED=true
MQTT_CA_CERT_PATH=/etc/ssl/certs/ca.crt
MQTT_CLIENT_CERT_PATH=/etc/ssl/certs/client.crt
MQTT_CLIENT_KEY_PATH=/etc/ssl/private/client.key

# Utilisateurs techniques MQTT (générés automatiquement)
MQTT_USER_PI=bender-pi
MQTT_PASS_PI=GenerateSecurePassword123
MQTT_USER_ESP32=bender-esp32
MQTT_PASS_ESP32=GenerateSecurePassword456
MQTT_USER_T630=bender-t630
MQTT_PASS_T630=GenerateSecurePassword789

# =============================================================================
# SERVICES T630 (Docker)
# =============================================================================

# Ollama LLM
OLLAMA_HOST=0.0.0.0
OLLAMA_PORT=11434
OLLAMA_MODEL=mistral:7b-instruct-q4_0
# Alternative: qwen2.5:7b-instruct-q4_0

# Piper TTS (Wyoming)
PIPER_HOST=0.0.0.0
PIPER_PORT=10200
PIPER_VOICE_DEFAULT=fr_FR-upmc-medium
# Alternative: fr_FR-siwis-medium

# faster-whisper ASR (Wyoming)
WHISPER_HOST=0.0.0.0
WHISPER_PORT=10300
WHISPER_MODEL=medium
WHISPER_LANGUAGE=fr

# =============================================================================
# AUDIO CONFIGURATION
# =============================================================================

# I²S Pinouts Pi5 (fixes, ne pas modifier)
I2S_BCLK_GPIO=18
I2S_LRCLK_GPIO=19
I2S_DIN_GPIO=20
I2S_DOUT_GPIO=21

# Audio settings
AUDIO_SAMPLE_RATE=48000
AUDIO_CHANNELS=2
AUDIO_BUFFER_SIZE=1024

# AEC (Acoustic Echo Cancellation)
AEC_ENABLED=true
AEC_FILTER_LENGTH=512
AEC_SUPPRESSION_LEVEL=2

# VAD (Voice Activity Detection)
VAD_ENABLED=true
VAD_AGGRESSIVENESS=2
VAD_FRAME_DURATION=30

# Plan B : DAC USB (si I²S full-duplex échoue)
USB_DAC_ENABLED=false
USB_DAC_DEVICE=hw:1,0

# =============================================================================
# LEDs ESP32
# =============================================================================

# GPIO Pinouts (fixes, ne pas modifier)
LED_TEETH_GPIO=16
LED_EYE_LEFT_GPIO=17
LED_EYE_RIGHT_GPIO=21

# LED counts
LED_TEETH_COUNT=18
LED_EYE_LEFT_COUNT=9
LED_EYE_RIGHT_COUNT=9

# LED settings
LED_BRIGHTNESS=128
LED_MAX_CURRENT_MA=3000
LED_POWER_SUPPLY_VOLTAGE=5

# =============================================================================
# TLS/CERTIFICATS
# =============================================================================

# Certificats auto-générés (recommandé)
TLS_AUTO_GENERATE=true
TLS_CA_VALIDITY_DAYS=3650
TLS_CERT_VALIDITY_DAYS=365

# Domaines/IPs à inclure dans certificats
TLS_DOMAINS=bender-pi.local,bender-t630.local
TLS_IPS=192.168.1.100,192.168.1.101

# Chemins certificats
TLS_CA_CERT_PATH=/etc/ssl/bender/ca.crt
TLS_CA_KEY_PATH=/etc/ssl/bender/ca.key
TLS_SERVER_CERT_PATH=/etc/ssl/bender/server.crt
TLS_SERVER_KEY_PATH=/etc/ssl/bender/server.key

# =============================================================================
# UI WEB
# =============================================================================

UI_HOST=0.0.0.0
UI_PORT=8443
UI_TLS_ENABLED=true
UI_SESSION_SECRET=GenerateRandomSessionSecret123456789

# =============================================================================
# MÉTRIQUES ET MONITORING
# =============================================================================

# Objectifs performance (ms)
METRICS_LAT_DOMOTIQUE_TARGET=1500
METRICS_LAT_CONVERSATION_TARGET=2500
METRICS_LED_SYNC_TARGET=60

# Seuils alertes
METRICS_CPU_WARNING=70
METRICS_CPU_CRITICAL=90
METRICS_TEMP_WARNING=70
METRICS_TEMP_CRITICAL=80

# Rétention données
METRICS_RETENTION_REALTIME_HOURS=24
METRICS_RETENTION_DAILY_DAYS=30
METRICS_RETENTION_MONTHLY_MONTHS=12

# =============================================================================
# DÉVELOPPEMENT
# =============================================================================

# Niveaux de log
LOG_LEVEL=INFO
# DEBUG, INFO, WARNING, ERROR, CRITICAL

# Mode développement
DEV_MODE=false
DEV_MOCK_HARDWARE=false
DEV_SKIP_TLS_VERIFY=false

# Tests
TEST_CORPUS_PATH=/opt/bender/test/corpus_fr.txt
TEST_WER_SAMPLES=100
TEST_LATENCY_SAMPLES=50

# =============================================================================
# PERSONA BENDER
# =============================================================================

BENDER_PERSONALITY=sarcastic
BENDER_LANGUAGE=fr
BENDER_VOICE_SPEED=1.0
BENDER_VOICE_PITCH=1.0
BENDER_MEMORY_ENABLED=true
BENDER_MEMORY_RETENTION_DAYS=30

# =============================================================================
# SÉCURITÉ
# =============================================================================

# Quotas logs audio (protection vie privée)
AUDIO_LOG_ENABLED=false
AUDIO_LOG_MAX_SIZE_MB=100
AUDIO_LOG_RETENTION_HOURS=24

# Rate limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10

# Fail2ban
FAIL2BAN_ENABLED=true
FAIL2BAN_MAX_RETRY=5
FAIL2BAN_BAN_TIME=600

# =============================================================================
# NOTES
# =============================================================================

# 1. Copier ce fichier vers .env.local
# 2. Remplir toutes les valeurs avec vos paramètres réels
# 3. .env.local est automatiquement ignoré par Git
# 4. Ne jamais committer de secrets en clair
# 5. Utiliser des mots de passe forts (≥16 caractères)
# 6. Régénérer les tokens/clés régulièrement